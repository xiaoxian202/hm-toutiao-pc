(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-06b3f3f7"],{8866:function(e,t,a){"use strict";var s=a("cbeb"),r=a.n(s);r.a},cbeb:function(e,t,a){},e036:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container-image"},[a("el-card",[a("div",{attrs:{slot:"header"},slot:"header"},[a("my-bread",[e._v("素材管理")])],1),a("div",{staticClass:"btn-box"},[a("el-radio-group",{attrs:{size:"small"},on:{change:e.toggleList},model:{value:e.reqparams.collect,callback:function(t){e.$set(e.reqparams,"collect",t)},expression:"reqparams.collect"}},[a("el-radio-button",{attrs:{label:!1}},[e._v("全部")]),a("el-radio-button",{attrs:{label:!0}},[e._v("收藏")])],1),a("el-button",{staticStyle:{float:"right"},attrs:{type:"success",size:"small"},on:{click:e.openDialog}},[e._v("添加素材")])],1),a("div",{staticClass:"list-box"},e._l(e.images,(function(t){return a("div",{key:t.id,staticClass:"item-box"},[a("img",{attrs:{src:t.url,alt:""}}),e.reqparams.collect?e._e():a("div",{staticClass:"option"},[a("span",{staticClass:"el-icon-star-off",class:{red:t.is_collected},on:{click:function(a){return e.toggStatus(t)}}}),a("span",{staticClass:"el-icon-delete",on:{click:function(a){return e.delImage(t.id)}}})])])})),0),a("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:e.total,"page-size":e.reqparams.per_page,"current-page":e.reqparams.page},on:{"current-change":e.changePager}})],1),a("el-dialog",{attrs:{title:"提示",visible:e.dialogVisible,width:"300px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"http://ttapi.research.itcast.cn/mp/v1_0/user/images",name:"image",headers:e.headers,"show-file-list":!1,"on-success":e.uploadSuccess}},[e.imageUrl?a("img",{staticClass:"avatar",attrs:{src:e.imageUrl}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)],1)},r=[],i=(a("96cf"),a("1da1")),n=a("5f87"),c={name:"page-image",data:function(){return{reqparams:{collect:!1,page:1,per_page:10},images:[],total:0,dialogVisible:!1,imageUrl:"",headers:{Authorization:"Bearer ".concat(n["a"].getUser().token)}}},created:function(){this.getImage()},methods:{uploadSuccess:function(e){var t=this;this.$message.success("上传成功"),this.imageUrl=e.data.url,window.setTimeout((function(){t.dialogVisible=!1,t.getImage()}),3e3)},getImage:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("user/images",{params:e.reqparams});case 2:a=t.sent,e.images=a.data.data.results,e.total=a.data.data.total_count;case 5:case"end":return t.stop()}}),t)})))()},changePager:function(e){this.reqparams.page=e,this.getImage()},toggleList:function(){this.reqparams.page=1,this.getImage()},delImage:function(e){var t=this;this.$confirm("此操作将永久删除该图片素材, 是否继续?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(i["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,t.$http.delete("user/images/".concat(e));case 3:t.$message.success("'删除图片素材成功!'"),t.getImage(),a.next=10;break;case 7:a.prev=7,a.t0=a["catch"](0),t.$message.error("'删除图片素材失败!'");case 10:case"end":return a.stop()}}),a,null,[[0,7]])})))).catch((function(){}))},toggStatus:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return s=!e.is_collected,a.prev=1,a.next=4,t.$http.put("user/images/".concat(e.id),{collect:s});case 4:t.$message.success(s?"添加收藏成功":"取消收藏成功"),e.is_collected=s,a.next=11;break;case 8:a.prev=8,a.t0=a["catch"](1),t.$message.error(s?"添加收藏失败":"取消收藏失败");case 11:case"end":return a.stop()}}),a,null,[[1,8]])})))()},openDialog:function(){this.dialogVisible=!0,this.imageUrl=null}}},o=c,l=(a("8866"),a("2877")),u=Object(l["a"])(o,s,r,!1,null,"522e2c98",null);t["default"]=u.exports}}]);
//# sourceMappingURL=chunk-06b3f3f7.e334da86.js.map