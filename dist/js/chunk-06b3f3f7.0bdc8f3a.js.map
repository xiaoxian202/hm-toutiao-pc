{"version":3,"sources":["webpack:///./src/views/image/index.vue?e8e7","webpack:///./src/views/image/index.vue?a90e","webpack:///src/views/image/index.vue","webpack:///./src/views/image/index.vue?1ec3","webpack:///./src/views/image/index.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","slot","_v","on","toggleList","model","value","reqparams","callback","$$v","$set","expression","staticStyle","openDialog","_l","item","key","id","url","collect","_e","class","is_collected","$event","toggStatus","delImage","total","per_page","page","changePager","dialogVisible","headers","uploadSuccess","imageUrl","staticRenderFns","updateStatus","component"],"mappings":"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","file":"js/chunk-06b3f3f7.0bdc8f3a.js","sourcesContent":["import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=522e2c98&lang=less&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=522e2c98&lang=less&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container-image\"},[_c('el-card',[_c('div',{attrs:{\"slot\":\"header\"},slot:\"header\"},[_c('my-bread',[_vm._v(\"素材管理\")])],1),_c('div',{staticClass:\"btn-box\"},[_c('el-radio-group',{attrs:{\"size\":\"small\"},on:{\"change\":_vm.toggleList},model:{value:(_vm.reqparams.collect),callback:function ($$v) {_vm.$set(_vm.reqparams, \"collect\", $$v)},expression:\"reqparams.collect\"}},[_c('el-radio-button',{attrs:{\"label\":false}},[_vm._v(\"全部\")]),_c('el-radio-button',{attrs:{\"label\":true}},[_vm._v(\"收藏\")])],1),_c('el-button',{staticStyle:{\"float\":\"right\"},attrs:{\"type\":\"success\",\"size\":\"small\"},on:{\"click\":_vm.openDialog}},[_vm._v(\"添加素材\")])],1),_c('div',{staticClass:\"list-box\"},_vm._l((_vm.images),function(item){return _c('div',{key:item.id,staticClass:\"item-box\"},[_c('img',{attrs:{\"src\":item.url,\"alt\":\"\"}}),(!_vm.reqparams.collect)?_c('div',{staticClass:\"option\"},[_c('span',{staticClass:\"el-icon-star-off\",class:{'red':item.is_collected},on:{\"click\":function($event){return _vm.toggStatus(item)}}}),_c('span',{staticClass:\"el-icon-delete\",on:{\"click\":function($event){return _vm.delImage(item.id)}}})]):_vm._e()])}),0),_c('el-pagination',{attrs:{\"background\":\"\",\"layout\":\"prev, pager, next\",\"total\":_vm.total,\"page-size\":_vm.reqparams.per_page,\"current-page\":_vm.reqparams.page},on:{\"current-change\":_vm.changePager}})],1),_c('el-dialog',{attrs:{\"title\":\"提示\",\"visible\":_vm.dialogVisible,\"width\":\"300px\"},on:{\"update:visible\":function($event){_vm.dialogVisible=$event}}},[_c('el-upload',{staticClass:\"avatar-uploader\",attrs:{\"action\":\"http://ttapi.research.itcast.cn/mp/v1_0/user/images\",\"name\":\"image\",\"headers\":_vm.headers,\"show-file-list\":false,\"on-success\":_vm.uploadSuccess}},[(_vm.imageUrl)?_c('img',{staticClass:\"avatar\",attrs:{\"src\":_vm.imageUrl}}):_c('i',{staticClass:\"el-icon-plus avatar-uploader-icon\"})])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"container-image\">\r\n    <el-card>\r\n        <!-- 面包屑 -->\r\n        <div slot=\"header\">\r\n            <my-bread>素材管理</my-bread>\r\n        </div>\r\n        <!--按钮 -->\r\n        <div class=\"btn-box\">\r\n            <el-radio-group v-model=\"reqparams.collect\" size=\"small\" @change=\"toggleList\">\r\n                <!-- label属性单个按钮的值，当你选中点击后，这个值赋值给reqparams.collaps -->\r\n                <!-- 但你el-radio-button组件中没有文字说明，label的值直接当做文字说明 -->\r\n                <el-radio-button :label=\"false\">全部</el-radio-button>\r\n                <el-radio-button :label=\"true\">收藏</el-radio-button>\r\n            </el-radio-group>\r\n            <el-button @click=\"openDialog\" style=\"float:right\" type=\"success\" size=\"small\">添加素材</el-button>\r\n        </div>\r\n        <!-- 列表 -->\r\n        <div class=\"list-box\">\r\n            <div class=\"item-box\" v-for=\"item in images\" :key=\"item.id\">\r\n                <img :src=\"item.url\" alt />\r\n                <div class=\"option\" v-if=\"!reqparams.collect\">\r\n                    <span class=\"el-icon-star-off\" @click=\"toggStatus(item)\" :class=\"{'red':item.is_collected}\"></span>\r\n                    <span class=\"el-icon-delete\" @click=\"delImage(item.id)\"></span>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <!-- 分页 -->\r\n        <el-pagination \r\n            background \r\n            layout=\"prev, pager, next\" \r\n            :total=\"total\"\r\n            :page-size=\"reqparams.per_page\"\r\n            :current-page=\"reqparams.page\"     \r\n            @current-change=\"changePager\"      \r\n            >\r\n        </el-pagination>\r\n    </el-card>\r\n    <!-- 对话框 -->\r\n    <el-dialog\r\n        title=\"提示\"\r\n        :visible.sync=\"dialogVisible\"\r\n        width=\"300px\">\r\n        <!-- 上传组件 -->\r\n        <el-upload\r\n            class=\"avatar-uploader\"\r\n            action=\"http://ttapi.research.itcast.cn/mp/v1_0/user/images\" \r\n            name=\"image\" \r\n            :headers=\"headers\"\r\n            :show-file-list=\"false\"\r\n            :on-success=\"uploadSuccess\">\r\n            <img v-if=\"imageUrl\" :src=\"imageUrl\" class=\"avatar\">\r\n            <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\r\n        </el-upload>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n// 导入auth\r\nimport auth from '@/utils/auth.js'\r\nexport default {\r\n    name:'page-image',\r\n    data() {\r\n        return {\r\n            // 查询条件\r\n            reqparams:{\r\n                // 是否为收藏，true查询收藏图片 false查询全部图片\r\n                //后台提供\r\n                collect:false, \r\n                //页码\r\n                page:1,\r\n                // 每页数量\r\n                per_page:10\r\n            },\r\n            // 素材列表\r\n            images:[],\r\n            // 总条数\r\n            total:0,\r\n            // 对话框显示或隐藏\r\n            dialogVisible:false,\r\n            // 预览图地址\r\n            imageUrl:'',\r\n            // 上传请求头对象\r\n            headers:{Authorization:`Bearer ${auth.getUser().token}`}\r\n        }\r\n    },\r\n    created() {\r\n        this.getImage()\r\n    },\r\n    methods:{\r\n        // 上传成功的钩子函数\r\n        // response后台返回的数据\r\n        uploadSuccess(response) {\r\n            // console.log(response);\r\n            // 提示+预览\r\n            this.$message.success('上传成功')\r\n            this.imageUrl = response.data.url\r\n            // 3s后：关闭弹框，刷洗列表\r\n            window.setTimeout(() => {\r\n                this.dialogVisible = false\r\n                this.getImage()\r\n            },3000)\r\n        },\r\n        // 获取素材列表\r\n        async getImage() {\r\n            const res = await this.$http.get('user/images',{params:this.reqparams})\r\n            // console.log(res.data);\r\n            // 素材列表\r\n            this.images = res.data.data.results\r\n            // 总条数\r\n            this.total = res.data.data.total_count\r\n        },\r\n        // 切换分页 页码改变时触发，回调函数是最新页码\r\n        changePager(newPage) {\r\n            this.reqparams.page = newPage\r\n            // 刷新列表\r\n            this.getImage()\r\n        },\r\n        // 全部与收藏切换 定值变化时触发的事件,\r\n        // 回调参数是选中的 Radio label 值\r\n        toggleList() {\r\n            this.reqparams.page = 1\r\n            this.getImage()\r\n        },\r\n        // 删除功能\r\n        delImage(id) {\r\n            this.$confirm('此操作将永久删除该图片素材, 是否继续?', '温馨提示', {\r\n                confirmButtonText: '确定',\r\n                cancelButtonText: '取消',\r\n                type: 'warning'\r\n            }).then(async () => {\r\n                // 点击确认\r\n                try {\r\n                    //调用接口\r\n                    await this.$http.delete(`user/images/${id}`)\r\n                    // 提示\r\n                    this.$message.success(\"'删除图片素材成功!'\")\r\n                    this.getImage()\r\n                } catch (error) {\r\n                    this.$message.error(\"'删除图片素材失败!'\")\r\n                }\r\n            }).catch(() => {\r\n                // 点击取消不作任何逻辑 \r\n            })\r\n        },\r\n        //收藏功能切换\r\n        async toggStatus(item) {\r\n            const updateStatus = !item.is_collected\r\n            try {\r\n                await this.$http.put(`user/images/${item.id}`,{\r\n                    // 和当前状态取反即可，收藏 -> 取消收藏，没收藏 -> 已收藏\r\n                    collect:updateStatus\r\n                })\r\n                // 成功提示\r\n                this.$message.success(updateStatus ? \"添加收藏成功\" : \"取消收藏成功\")\r\n                // 根据修改后的状态去改，星星的颜色，修改图片数据对应的状态is_collected即可\r\n                item.is_collected = updateStatus\r\n            } catch (error) {\r\n                this.$message.error(updateStatus ? \"添加收藏失败\" : \"取消收藏失败\")\r\n            }\r\n        },\r\n        // 添加素材\r\n        openDialog() {\r\n            // 显示上传组件\r\n            this.dialogVisible = true\r\n            // 清空预览图\r\n            this.imageUrl = null\r\n        },\r\n        \r\n    }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n    // 列表样式\r\n    .list-box {\r\n        margin-top: 20px;\r\n        .item-box {\r\n            display: inline-block;\r\n            width: 180px;\r\n            height: 180px;\r\n            margin-right: 60px;\r\n            border: 1px dashed #ddd;\r\n            position: relative;\r\n            margin-bottom: 20px;\r\n            img{\r\n               display: block;\r\n               width: 100%;\r\n               height: 100%; \r\n            }\r\n            .option{\r\n                width: 100%;\r\n                height: 30px;\r\n                position: absolute;\r\n                left: 0;\r\n                bottom: 0;\r\n                background: rgba(0, 0, 0, 0.3);\r\n                text-align: center;\r\n                line-height: 30px;\r\n                span{\r\n                    color: #fff;\r\n                    margin: 0 20px;\r\n                    // 不加&解析后：span .red{} 后代选择器\r\n                    // 加上&节后后：span.red{}  交集选择器\r\n                    &.red {\r\n                        color:red;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=522e2c98&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=522e2c98&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"522e2c98\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}